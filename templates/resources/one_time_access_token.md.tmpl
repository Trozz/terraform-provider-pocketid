---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "{{.Name}} {{.Type}} - {{.ProviderName}}"
subcategory: ""
description: |-
{{ .Description | plainmarkdown | trimspace | prefixlines "  " }}
---

# {{.Name}} ({{.Type}})

{{ .Description | trimspace }}

## Example Usage

```terraform
# Create a one-time access token for a user (expires_at is required)
resource "pocketid_one_time_access_token" "example" {
  user_id    = pocketid_user.example.id
  expires_at = timeadd(timestamp(), "24h") # Token expires in 24 hours
}

# Create a one-time access token with custom expiry (1 hour from now)
resource "pocketid_one_time_access_token" "temporary" {
  user_id    = pocketid_user.example.id
  expires_at = timeadd(timestamp(), "1h")
}

# Example with user creation
resource "pocketid_user" "example" {
  username   = "temporary.user"
  email      = "temp@example.com"
  first_name = "Temporary"
  last_name  = "User"
}

# Output the token (marked as sensitive)
output "access_token" {
  description = "The one-time access token for the user"
  value       = pocketid_one_time_access_token.example.token
  sensitive   = true
}

# Use case: Create a token for emergency access
resource "pocketid_user" "emergency" {
  username   = "emergency.access"
  email      = "emergency@example.com"
  first_name = "Emergency"
  last_name  = "Access"
  is_admin   = true
}

resource "pocketid_one_time_access_token" "emergency" {
  user_id    = pocketid_user.emergency.id
  expires_at = timeadd(timestamp(), "24h") # Valid for 24 hours
}

# Note: One-time access tokens are useful when users need to authenticate
# from a device where they don't have access to their passkey.
# The token can only be used once and should be treated as a secret.

# Use case: Initial user setup with skip_recreate
# This prevents Terraform from recreating the token after it's been used
resource "pocketid_user" "new_user" {
  username   = "new.employee"
  email      = "new.employee@company.com"
  first_name = "New"
  last_name  = "Employee"
}

resource "pocketid_one_time_access_token" "onboarding" {
  user_id       = pocketid_user.new_user.id
  expires_at    = timeadd(timestamp(), "168h") # Valid for 7 days
  skip_recreate = true                         # Don't recreate if token is used
}

# Send the token via another provider (e.g., email, SMS)
# This is just an example - use your actual notification provider
resource "example_email" "welcome" {
  to      = pocketid_user.new_user.email
  subject = "Welcome to Pocket-ID"
  body    = <<-EOT
    Welcome ${pocketid_user.new_user.first_name}!

    Please use this one-time access token to log in and set up your passkey:
    ${pocketid_one_time_access_token.onboarding.token}

    This token will expire in 7 days.
  EOT
}
```

{{ .SchemaMarkdown | trimspace }}

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# One-time access tokens can be imported using the user ID
terraform import pocketid_one_time_access_token.example "user-id-123"

# Note: The token value itself cannot be retrieved after creation,
# so it will not be available in the state after import.
```
